--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -173,5 +173,35 @@ add_library(osrm_contract src/osrm/contractor.cpp $<TARGET_OBJECTS:CONTRACTOR> $<TARGET_OBJECTS:UTIL>)
+if(WIN32)
+    # Help CMake find Boost's config package, which currently ships in a nested directory
+    # On Windows, CMAKE_INSTALL_PREFIX/bin is where libraries are installed
+    if(NOT Boost_DIR)
+        if(EXISTS "${CMAKE_INSTALL_PREFIX}/bin/cmake/Boost-1.87.0")
+            set(Boost_DIR "${CMAKE_INSTALL_PREFIX}/bin/cmake/Boost-1.87.0" CACHE PATH "Boost directory")
+        elseif(EXISTS "${CMAKE_INSTALL_PREFIX}/lib/cmake/Boost-1.87.0")
+            set(Boost_DIR "${CMAKE_INSTALL_PREFIX}/lib/cmake/Boost-1.87.0" CACHE PATH "Boost directory")
+        endif()
+    endif()
+    # Help CMake find Lua library on Windows
+    # On Windows, libraries are in CMAKE_INSTALL_PREFIX/bin
+    if(NOT LUA_LIBRARIES)
+        if(EXISTS "${CMAKE_INSTALL_PREFIX}/bin/lua54.dll.a")
+            set(LUA_LIBRARIES "${CMAKE_INSTALL_PREFIX}/bin/lua54.dll.a" CACHE FILEPATH "Lua library")
+        elseif(EXISTS "${CMAKE_INSTALL_PREFIX}/lib/lua54.dll.a")
+            set(LUA_LIBRARIES "${CMAKE_INSTALL_PREFIX}/lib/lua54.dll.a" CACHE FILEPATH "Lua library")
+        else
+            # Fallback: let CMake find it with library directory hint
+            set(LUA_LIBRARIES "lua54" CACHE STRING "Lua library")
+            set(LUA_LIB_DIR "${CMAKE_INSTALL_PREFIX}/bin" CACHE PATH "Lua library directory")
+        endif()
+    endif()
+    if(NOT LUA_INCLUDE_DIR)
+        set(LUA_INCLUDE_DIR "${CMAKE_INSTALL_PREFIX}/include" CACHE PATH "Lua include directory")
+    endif()
+endif()
 add_library(osrm_extract src/osrm/extractor.cpp $<TARGET_OBJECTS:EXTRACTOR> $<TARGET_OBJECTS:MICROTAR> $<TARGET_OBJECTS:UTIL>)
-add_library(osrm_guidance $<TARGET_OBJECTS:GUIDANCE> $<TARGET_OBJECTS:UTIL>)
+add_library(osrm_guidance $<TARGET_OBJECTS:GUIDANCE> $<TARGET_OBJECTS:UTIL> $<TARGET_OBJECTS:MICROTAR>)
+target_link_libraries(osrm_guidance PRIVATE EXTRACTOR ${LUA_LIBRARIES})
+target_link_libraries(osrm_guidance PRIVATE BZip2::BZip2 EXPAT::EXPAT Boost::iostreams)
+target_link_libraries(osrm_contract PRIVATE ${LUA_LIBRARIES})
 add_library(osrm_partition src/osrm/partitioner.cpp $<TARGET_OBJECTS:PARTITIONER> $<TARGET_OBJECTS:MICROTAR> $<TARGET_OBJECTS:UTIL>)
 add_library(osrm_customize src/osrm/customizer.cpp $<TARGET_OBJECTS:CUSTOMIZER> $<TARGET_OBJECTS:MICROTAR> $<TARGET_OBJECTS:UTIL>)
