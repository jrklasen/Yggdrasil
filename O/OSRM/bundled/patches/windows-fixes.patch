--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -181,4 +181,14 @@ add_library(osrm_contract src/osrm/contractor.cpp $<TARGET_OBJECTS:CONTRACTOR> $<TARGET_OBJECTS:UTIL>)
 add_library(osrm_extract src/osrm/extractor.cpp $<TARGET_OBJECTS:EXTRACTOR> $<TARGET_OBJECTS:MICROTAR> $<TARGET_OBJECTS:UTIL>)
-add_library(osrm_guidance $<TARGET_OBJECTS:GUIDANCE> $<TARGET_OBJECTS:UTIL>)
+add_library(osrm_guidance $<TARGET_OBJECTS:GUIDANCE> $<TARGET_OBJECTS:UTIL> $<TARGET_OBJECTS:MICROTAR>)
+target_link_libraries(osrm_guidance PRIVATE EXTRACTOR ${LUA_LIBRARIES})
+if(TARGET BZip2::BZip2)
+    target_link_libraries(osrm_guidance PRIVATE BZip2::BZip2)
+endif()
+if(TARGET EXPAT::EXPAT)
+    target_link_libraries(osrm_guidance PRIVATE EXPAT::EXPAT)
+endif()
+if(TARGET Boost::iostreams)
+    target_link_libraries(osrm_guidance PRIVATE Boost::iostreams)
+endif()
 add_library(osrm_partition src/osrm/partitioner.cpp $<TARGET_OBJECTS:PARTITIONER> $<TARGET_OBJECTS:MICROTAR> $<TARGET_OBJECTS:UTIL>)
 add_library(osrm_customize src/osrm/customizer.cpp $<TARGET_OBJECTS:CUSTOMIZER> $<TARGET_OBJECTS:MICROTAR> $<TARGET_OBJECTS:UTIL>)
